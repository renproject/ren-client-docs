"use strict";(self.webpackChunkren_client_docs=self.webpackChunkren_client_docs||[]).push([[4469],{3905:function(e,n,t){t.d(n,{Zo:function(){return c},kt:function(){return m}});var a=t(67294);function r(e,n,t){return n in e?Object.defineProperty(e,n,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[n]=t,e}function i(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);n&&(a=a.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,a)}return t}function l(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?i(Object(t),!0).forEach((function(n){r(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):i(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}function o(e,n){if(null==e)return{};var t,a,r=function(e,n){if(null==e)return{};var t,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||(r[t]=e[t]);return r}(e,n);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)t=i[a],n.indexOf(t)>=0||Object.prototype.propertyIsEnumerable.call(e,t)&&(r[t]=e[t])}return r}var s=a.createContext({}),u=function(e){var n=a.useContext(s),t=n;return e&&(t="function"==typeof e?e(n):l(l({},n),e)),t},c=function(e){var n=u(e.components);return a.createElement(s.Provider,{value:n},e.children)},d={inlineCode:"code",wrapper:function(e){var n=e.children;return a.createElement(a.Fragment,{},n)}},p=a.forwardRef((function(e,n){var t=e.components,r=e.mdxType,i=e.originalType,s=e.parentName,c=o(e,["components","mdxType","originalType","parentName"]),p=u(t),m=r,f=p["".concat(s,".").concat(m)]||p[m]||d[m]||i;return t?a.createElement(f,l(l({ref:n},c),{},{components:t})):a.createElement(f,l({ref:n},c))}));function m(e,n){var t=arguments,r=n&&n.mdxType;if("string"==typeof e||r){var i=t.length,l=new Array(i);l[0]=p;var o={};for(var s in n)hasOwnProperty.call(n,s)&&(o[s]=n[s]);o.originalType=e,o.mdxType="string"==typeof e?e:r,l[1]=o;for(var u=2;u<i;u++)l[u]=t[u];return a.createElement.apply(null,l)}return a.createElement.apply(null,t)}p.displayName="MDXCreateElement"},92704:function(e,n,t){t.r(n),t.d(n,{contentTitle:function(){return d},default:function(){return h},frontMatter:function(){return c},metadata:function(){return p},toc:function(){return m}});var a=t(87462),r=t(63366),i=(t(67294),t(3905)),l=t(26396),o=t(58215),s=t(93454),u=["components"],c={title:"Chain Utils",slug:"/how-to/chain-utils"},d=void 0,p={unversionedId:"v2/how-to/chain-utils",id:"v2/how-to/chain-utils",title:"Chain Utils",description:"The Chain classes exported by @renproject/chains provide utils for doing the following tasks:",source:"@site/ren-js/v2/how-to/chain-utils.mdx",sourceDirName:"v2/how-to",slug:"/how-to/chain-utils",permalink:"/ren-client-docs/ren-js/how-to/chain-utils",editUrl:"https://github.com/renproject/ren-client-docs/edit/master/ren-js/v2/how-to/chain-utils.mdx",tags:[],version:"current",frontMatter:{title:"Chain Utils",slug:"/how-to/chain-utils"},sidebar:"docs",previous:{title:"Resuming transfers",permalink:"/ren-client-docs/ren-js/how-to/resuming-transfers"},next:{title:"Handling address expiry and uniqueness",permalink:"/ren-client-docs/ren-js/how-to/handling-address-expiry"}},m=[{value:"Getting fee details",id:"getting-fee-details",children:[],level:2},{value:"Explorer links, asset decimals, address validation",id:"explorer-links-asset-decimals-address-validation",children:[],level:2}],f={toc:m};function h(e){var n=e.components,t=(0,r.Z)(e,u);return(0,i.kt)("wrapper",(0,a.Z)({},f,t,{components:n,mdxType:"MDXLayout"}),(0,i.kt)(s.G,{type:s.e.HowTo,mdxType:"DocTag"}),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Chain")," classes exported by ",(0,i.kt)("inlineCode",{parentName:"p"},"@renproject/chains")," provide utils for doing the following tasks:"),(0,i.kt)("p",null,"All chains:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Check that an address is valid"),(0,i.kt)("li",{parentName:"ul"},"Generate explorer links for addresses and transactions"),(0,i.kt)("li",{parentName:"ul"},"Query an asset's number of decimals, for displaying human-readable balances"),(0,i.kt)("li",{parentName:"ul"},"Get the transaction ID (as a ",(0,i.kt)("inlineCode",{parentName:"li"},"string"),") from a ",(0,i.kt)("inlineCode",{parentName:"li"},"Transaction")," object"),(0,i.kt)("li",{parentName:"ul"},"Fetch the transaction details (a ",(0,i.kt)("inlineCode",{parentName:"li"},"Transaction")," object) from a transaction ID."),(0,i.kt)("li",{parentName:"ul"},"Calculate the number of confirmations (or another measure of finality confidence) for transactions")),(0,i.kt)("p",null,"Mint chains:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Get an address's balance of a ren-asset"),(0,i.kt)("li",{parentName:"ul"},"Get the on-chain RenVM fees")),(0,i.kt)("p",null,"Using these utils can allow you to easily add new chains in the future, knowing that they will provide the same interface."),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"getting-fee-details"},"Getting fee details"),(0,i.kt)("p",null,"To fetch the estimated fees of a burn or mint, you can call ",(0,i.kt)("inlineCode",{parentName:"p"},"renJS.getFees"),", passing in the same asset and chain details:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},'await renJS.getFees({\n    asset: "BTC",\n    from: Bitcoin(),\n    to: Ethereum(provider, "testnet"),\n});\n')),(0,i.kt)("p",null,"The returned value will have four fields:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"{\n    lock?: BigNumber;\n    release?: BigNumber;\n    mint: number;\n    burn: number;\n}\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"lock")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"release"),", in the asset's smallest unit, are the transaction fees subtracted from the transaction amount when RenVM is moving the asset into or out of the network's custody. For going from one mint-chain to another (not yet supported), ",(0,i.kt)("inlineCode",{parentName:"li"},"lock")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"release")," will be ",(0,i.kt)("inlineCode",{parentName:"li"},"undefined"),"."),(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mint")," and ",(0,i.kt)("inlineCode",{parentName:"li"},"burn")," are the portion of the transaction amount charged by RenVM, in BPS (1 BPS equals 0.01%).")),(0,i.kt)("hr",null),(0,i.kt)("h2",{id:"explorer-links-asset-decimals-address-validation"},"Explorer links, asset decimals, address validation"),(0,i.kt)("p",null,"Each chain class (",(0,i.kt)("inlineCode",{parentName:"p"},"Bitcoin"),", ",(0,i.kt)("inlineCode",{parentName:"p"},"Ethereum"),", etc.) provide a common set of helper methods:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"await assetDecimals(asset)")," - returns the number of decimals used by the asset."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},'utils.addressIsValid("miMi2VET...")')," - returns whether the the parameter is a valid address.")),(0,i.kt)("p",null,"The parameters to the following depend on how the chain defines an ",(0,i.kt)("inlineCode",{parentName:"p"},"Address")," and a ",(0,i.kt)("inlineCode",{parentName:"p"},"Transaction"),"."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"utils.addressExplorerLink(address)")," - returns a link to the address in a chain explorer."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"utils.transactionExplorerLink(transaction)")," - returns a link to the transaction in a chain explorer."),(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("inlineCode",{parentName:"li"},"utils.transactionID(transaction)")," - returns the hash or ID of the transaction as a string.")),(0,i.kt)("p",null,"Transactions can be retrieved from a deposit object by taking ",(0,i.kt)("inlineCode",{parentName:"p"},"deposit.depositDetails.transaction"),"."),(0,i.kt)("p",null,"The ",(0,i.kt)("inlineCode",{parentName:"p"},"Address")," and ",(0,i.kt)("inlineCode",{parentName:"p"},"Transaction")," formats for various chains are:"),(0,i.kt)(l.Z,{defaultValue:"Bitcoin",values:[{label:"Bitcoin",value:"Bitcoin"},{label:"Ethereum",value:"Ethereum"},{label:"Filecoin",value:"Filecoin"}],mdxType:"Tabs"},(0,i.kt)(o.Z,{value:"Bitcoin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"// Same for Bitcoin forks.\n\ntype Address = string;\n\ninterface Transaction {\n    readonly txHash: string;\n    readonly vOut: number;\n    readonly amount: number;\n    readonly scriptPubKey?: string;\n    readonly confirmations: number;\n}\n"))),(0,i.kt)(o.Z,{value:"Ethereum",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"// Same for other EVM chains like Binance Smart Chain.\n\ntype Transaction = string; // The transaction hash.\ntype Address = string;\n"))),(0,i.kt)(o.Z,{value:"Filecoin",mdxType:"TabItem"},(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-ts"},"interface Address {\n    address: string; // Filecoin address\n    params?: string; // base64 params\n}\n\ninterface Transaction {\n    cid: string;\n    amount: string; // 18 decimal places\n    params: string; // base64\n    confirmations: number;\n    nonce: number;\n}\n")))))}h.isMDXComponent=!0},93454:function(e,n,t){t.d(n,{G:function(){return o},e:function(){return r}});var a,r,i=t(67294);!function(e){e.Tutorial="Tutorial",e.HowTo="How To",e.Reference="Reference",e.Explanation="Explanation"}(r||(r={}));var l=((a={})[r.Tutorial]="#b48ead",a[r.HowTo]="#69a8b9",a[r.Reference]="#bf616a",a[r.Explanation]="#d2b06c",a),o=function(e){var n=e.type,t=e.marginBottom;return i.createElement(i.Fragment,null,i.createElement("span",{style:{border:"2px solid "+l[n]||0,borderRadius:"5px",color:l[n]||"orange",padding:"0.1rem 0.4rem",marginBottom:void 0!==t?t:30,display:"inline-block"}},String(n)))}},58215:function(e,n,t){var a=t(67294);n.Z=function(e){var n=e.children,t=e.hidden,r=e.className;return a.createElement("div",{role:"tabpanel",hidden:t,className:r},n)}},26396:function(e,n,t){t.d(n,{Z:function(){return p}});var a=t(87462),r=t(67294),i=t(72389),l=t(79443);var o=function(){var e=(0,r.useContext)(l.Z);if(null==e)throw new Error('"useUserPreferencesContext" is used outside of "Layout" component.');return e},s=t(53810),u=t(86010),c="tabItem_vU9c";function d(e){var n,t,i,l=e.lazy,d=e.block,p=e.defaultValue,m=e.values,f=e.groupId,h=e.className,v=r.Children.map(e.children,(function(e){if((0,r.isValidElement)(e)&&void 0!==e.props.value)return e;throw new Error("Docusaurus error: Bad <Tabs> child <"+("string"==typeof e.type?e.type:e.type.name)+'>: all children of the <Tabs> component should be <TabItem>, and every <TabItem> should have a unique "value" prop.')})),k=null!=m?m:v.map((function(e){var n=e.props;return{value:n.value,label:n.label,attributes:n.attributes}})),b=(0,s.lx)(k,(function(e,n){return e.value===n.value}));if(b.length>0)throw new Error('Docusaurus error: Duplicate values "'+b.map((function(e){return e.value})).join(", ")+'" found in <Tabs>. Every value needs to be unique.');var g=null===p?p:null!=(n=null!=p?p:null==(t=v.find((function(e){return e.props.default})))?void 0:t.props.value)?n:null==(i=v[0])?void 0:i.props.value;if(null!==g&&!k.some((function(e){return e.value===g})))throw new Error('Docusaurus error: The <Tabs> has a defaultValue "'+g+'" but none of its children has the corresponding value. Available values are: '+k.map((function(e){return e.value})).join(", ")+". If you intend to show no default tab, use defaultValue={null} instead.");var y=o(),N=y.tabGroupChoices,w=y.setTabGroupChoices,T=(0,r.useState)(g),C=T[0],x=T[1],E=[],O=(0,s.o5)().blockElementScrollPositionUntilNextRender;if(null!=f){var j=N[f];null!=j&&j!==C&&k.some((function(e){return e.value===j}))&&x(j)}var D=function(e){var n=e.currentTarget,t=E.indexOf(n),a=k[t].value;a!==C&&(O(n),x(a),null!=f&&w(f,a))},P=function(e){var n,t=null;switch(e.key){case"ArrowRight":var a=E.indexOf(e.currentTarget)+1;t=E[a]||E[0];break;case"ArrowLeft":var r=E.indexOf(e.currentTarget)-1;t=E[r]||E[E.length-1]}null==(n=t)||n.focus()};return r.createElement("div",{className:"tabs-container"},r.createElement("ul",{role:"tablist","aria-orientation":"horizontal",className:(0,u.Z)("tabs",{"tabs--block":d},h)},k.map((function(e){var n=e.value,t=e.label,i=e.attributes;return r.createElement("li",(0,a.Z)({role:"tab",tabIndex:C===n?0:-1,"aria-selected":C===n,key:n,ref:function(e){return E.push(e)},onKeyDown:P,onFocus:D,onClick:D},i,{className:(0,u.Z)("tabs__item",c,null==i?void 0:i.className,{"tabs__item--active":C===n})}),null!=t?t:n)}))),l?(0,r.cloneElement)(v.filter((function(e){return e.props.value===C}))[0],{className:"margin-vert--md"}):r.createElement("div",{className:"margin-vert--md"},v.map((function(e,n){return(0,r.cloneElement)(e,{key:n,hidden:e.props.value!==C})}))))}function p(e){var n=(0,i.Z)();return r.createElement(d,(0,a.Z)({key:String(n)},e))}}}]);